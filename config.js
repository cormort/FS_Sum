// config.js

export const CONFIG_OPERATING = {
    '收支表': { parser: 'dynamic_normal', sheetKeyword: '收支', keyColumn: '科目', columns: ['科目', '預算數', '原列決算數', '修正數', '決算核定數', '預算數與決算核定數比較增減'] },
    '撥補表': { parser: 'dynamic_normal', sheetKeyword: '撥補', keyColumn: '項目', columns: ['項目', '預算數', '原列決算數', '修正數', '決算核定數', '預算數與決算核定數比較增減'] },
    '現流表': { parser: 'dynamic_normal', sheetKeyword: '現流', keyColumn: '項目', columns: ['項目', '預算數', '決算核定數', '比較增減'] },
    '平衡表': { parser: 'balance_sheet', sheetKeyword: '平衡', keyColumn: '科目', columns: ['科目', '本年度決算核定數', '上年度決算審定數', '比較增減'] }
};
export const CONFIG_GOVERNMENTAL = {
    '餘絀表': { parser: 'fixed_yuchu', sheetKeyword: '餘絀', keyColumn: '項目', columns: ['項目', '預算數', '原列決算數', '修正數', '決算核定數', '預算與決算核定數比較增減'] },
    '收支表': { parser: 'fixed_shouzhi', sheetKeyword: '收支', keyColumn: '科目', columns: ['科目', '原列決算數', '修正數', '決算核定數'] },
    '現流表': { parser: 'fixed_xianliu', sheetKeyword: '現流', keyColumn: '項目', columns: ['項目', '決算核定數'] },
    '平衡表': { parser: 'balance_sheet', sheetKeyword: '平衡', keyColumn: '科目', columns: ['科目', '本年度決算核定數', '上年度決算審定數', '比較增減'] }
};

export const CONFIG_BUSINESS = {
    '損益表': { parser: 'fixed_business_profitloss_stateful', sheetKeyword: '損益', keyColumn: '科目', columns: ['科目', '上年度決算數', '本年度預算數', '原列決算數', '修正數', '決算核定數'] },
    // ★★★ 更新盈虧撥補表的解析器名稱 ★★★
    '盈虧撥補表': { parser: 'fixed_business_appropriation_stateful', sheetKeyword: '盈虧', keyColumn: '項目', columns: ['項目', '上年度決算數', '本年度預算數', '原列決算數', '修正數', '決算核定數'] },
    '現金流量表': { parser: 'fixed_business_cashflow', sheetKeyword: '現流', keyColumn: '項目', columns: ['項目', '本年度預算數', '原列決算數', '修正數', '決算核定數'] },
    '資產負債表': { parser: 'fixed_business_balancesheet_sidebyside', sheetKeyword: '資負', keyColumn: '科目', columns: ['科目', '上年度決算數', '原列決算數', '修正數', '決算核定數'] }
};

export const FULL_CONFIG = {
    'operating': CONFIG_OPERATING,
    'governmental': CONFIG_GOVERNMENTAL,
    'business': CONFIG_BUSINESS
};

// --- 排序藍圖 ---

export const PROFIT_LOSS_ACCOUNT_ORDER = [
    '營業收入', '銷售收入', '勞務收入', '金融保險收入', '採用權益法認列之關聯企業及合資利益之份額', '其他營業收入',
    '營業成本', '銷售成本', '勞務成本', '金融保險成本', '採用權益法認列之關聯企業及合資損失之份額', '其他營業成本',
    '營業毛利（毛損）',
    '營業費用', '行銷費用', '業務費用', '管理費用', '其他營業費用',
    '營業利益（損失）',
    '營業外收入', '財務收入', '採用權益法認列之關聯企業及合資利益之份額 (營業外)', '其他營業外收入',
    '營業外費用', '財務成本', '採用權益法認列之關聯企業及合資損失之份額 (營業外)', '其他營業外費用',
    '營業外利益（損失）',
    '稅前淨利（淨損）', '所得稅費用（利益）', '繼續營業單位本期淨利（淨損）', '停業單位損益', '本期淨利（淨損）',
    '本期淨利（淨損）歸屬於：', '母公司業主', '非控制權益'
];

// ★★★ 更新盈虧撥補表的排序藍圖，使用唯一的科目名稱 ★★★
export const APPROPRIATION_ACCOUNT_ORDER = [
    '盈餘之部', '本期淨利', '累積盈餘', '追溯適用及追溯重編之影響數', '公積轉列數', '出售庫藏股票損失', '其他綜合損益轉入數 (盈餘之部)',
    '分配之部', '中央政府所得者', '股（官）息紅利', '地方政府所得者', '股（官）息紅利', '轉投資機關所得者', '股（官）息紅利', '其他政府機關所得者', '股（官）息紅利', '民股股東所得者', '股息紅利', '其他所得者', '提撥地方政府', '其他依法分配數',
    '留存事業機關者', '填補虧損', '資本公積', '法定公積', '特別公積', '未分配盈餘',
    '虧損之部', '本期淨損', '累積虧損', '追溯適用及追溯重編之影響數', '其他綜合損益轉入數 (虧損之部)',
    '填補之部', '中央政府負擔者', '折減資本', '出資填補', '地方政府負擔者', '折減資本', '出資填補', '轉投資機關負擔者', '折減資本', '出資填補', '其他政府機關負擔者', '折減資本', '出資填補', '民股股東負擔者', '折減資本', '出資填補',
    '事業機關負擔者', '撥用盈餘', '撥用法定公積', '撥用特別公積', '撥用資本公積', '待填補之虧損'
];

// ★★★ 新增現金流量表的排序藍圖 ★★★
export const CASH_FLOW_ACCOUNT_ORDER = [
    // --- 營業活動 ---
    '營業活動之現金流量',
    '繼續營業單位稅前淨利（淨損）',
    '停業單位稅前淨利（淨損）',
    '稅前淨利（淨損）',
    '利息股利之調整',
    '未計利息股利之稅前淨利（淨損）',
    '調整項目',
    '未計利息股利之現金流入（流出）',
    '收取利息',
    '收取股利',
    '支付利息',
    '發放現金股利',
    '退還（支付）所得稅',
    '營業活動之淨現金流入（流出）',
    // --- 投資活動 ---
    '投資活動之現金流量',
    '流動金融資產淨減（淨增）',
    '減少投資',
    '減少投資子公司',
    '減少基金及長期應收款',
    '減少不動產、廠房及設備',
    '減少使用權資產',
    '減少投資性不動產',
    '減少生物資產',
    '無形資產及其他資產淨減（淨增）',
    '其他投資活動之現金流入',
    '增加投資',
    '增加投資子公司',
    '增加基金及長期應收款',
    '增加不動產、廠房及設備',
    '增加使用權資產',
    '增加投資性不動產',
    '增加生物資產',
    '其他投資活動之現金流出',
    '投資活動之淨現金流入（流出）',
    // --- 籌資活動 ---
    '籌資活動之現金流量',
    '短期債務淨增（淨減）',
    '流動金融負債淨增（淨減）',
    '金融債券淨增（淨減）',
    '央行及同業融資淨增（淨減）',
    '增加長期債務',
    '增加非流動金融負債',
    '其他負債淨增（淨減）',
    '增加資本、公積及填補虧損',
    '其他籌資活動之現金流入',
    '減少長期債務',
    '減少非流動金融負債',
    '減少資本',
    '其他籌資活動之現金流出',
    '籌資活動之淨現金流入（流出）',
    // --- 結尾 ---
    '匯率影響數',
    '現金及約當現金之淨增（淨減）',
    '期初現金及約當現金',
    '期末現金及約當現金'
];
